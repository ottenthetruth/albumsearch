<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="general.css">
    <link rel="stylesheet" href="searchforalbums.css">
    <title>Search for Albums!</title>
</head>

<body>
  <div class="myheader">
      <div class="banner">
          <h1 id="bannerText">YOUR WEBSITE BANNER</h1>
          <div class="nav-container">
              <a class="imherebutton">Search for Albums!</a>
              <a href="page2.html" class="page-button">My Profile</a>
              <a href="page3.html" class "page-button">Featured</a>
              <a href="page4.html" class "page-button">Page 4</a>
              <a href="page5.html" class "page-button">About RYM</a>
          </div>
      </div>
  </div>

<div class="parent">

    <div class="div1">
      <div class="search-bar">
            <input type="text" id="mysearch" class="search-input"  placeholder="Start Searching here!">
            <a onclick="getAlbums()" class="search-button">Search!</a>
      </div>
    </div>
    <div id="album-results" class="album-results-container"></div>
</div>

<div class="album-info">
    <h2 id="album-name"></h2>
    <p id="artist-name"></p>
    <img id="album-cover" src="" alt="Album Cover">
</div>

<script>
    async function getAccessToken() {
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get("code");
        if (code) {
            // Your code to get the access token
        }
    }

    async function getAlbums() {
        const accessToken = await getAccessToken();
        if (accessToken) {
            const searchQuery = document.getElementById("mysearch").value;
            const response = await fetch(`https://api.spotify.com/v1/search?q=album:${searchQuery}&type=album&limit=1`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${accessToken}`,
                },
            });

            if (response.status === 200) {
                const data = await response.json();
                const albumData = data.albums.items[0];

                if (albumData) {
                    const albumName = albumData.name;
                    const artistName = albumData.artists[0].name;
                    const albumCoverUrl = albumData.images[0].url;

                    document.getElementById('album-name').textContent = albumName;
                    document.getElementById('artist-name').textContent = artistName;

                    const albumCoverElement = document.getElementById('album-cover');
                    albumCoverElement.src = albumCoverUrl;
                    albumCoverElement.alt = `${albumName} Album Cover`;
                } else {
                    alert('No album found.');
                }
            } else {
                document.getElementById('album-name').textContent = 'Not currently playing anything on Spotify.';
            }
        }
    }
</script>

</body>
</html>
